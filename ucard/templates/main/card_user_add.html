<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>添加用卡人</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/static/layui/css/layui.css" media="all">
    <style>
        .layui-form-item .layui-input-inline {
            width: 280px;
        }
        .layui-form {
            margin: 20px;
        }
        .card-user-info {
            margin: 20px 0;
            font-size: 16px;
            font-weight: bold;
            border-left: 5px solid #1E9FFF;
            padding-left: 10px;
        }
        .address-title {
            margin: 30px 0 20px 0;
            font-size: 16px;
            font-weight: bold;
            border-left: 5px solid #1E9FFF;
            padding-left: 10px;
        }
        .layui-form-select dl {
            max-height: 200px;
        }
    </style>
</head>
<body>

<form class="layui-form" lay-filter="user-form">
    <div class="card-user-info">
        <i class="layui-icon layui-icon-user"></i> 用卡人详情
    </div>
    
    <div class="layui-form-item">
        <label class="layui-form-label">名字<span style="color: red;">*</span></label>
        <div class="layui-input-inline">
            <input type="text" name="first_name" lay-verify="required" placeholder="请输入名字" autocomplete="off" class="layui-input">
        </div>
    </div>
    
    <div class="layui-form-item">    
        <label class="layui-form-label">姓氏<span style="color: red;">*</span></label>
        <div class="layui-input-inline">
            <input type="text" name="last_name" lay-verify="required" placeholder="请输入姓氏" autocomplete="off" class="layui-input">
        </div>
    </div>
    
    <div class="layui-form-item">
        <label class="layui-form-label">国籍<span style="color: red;">*</span></label>
        <div class="layui-input-inline">
            <select name="region" lay-verify="required">
                <option value="US" selected>美国</option>
                <option value="TW">台湾（中国）</option>
                <option value="CN">中国</option>
                <option value="VN">越南</option>
                <option value="TH">泰国</option>
                <option value="SG">新加坡</option>
                <option value="PK">巴基斯坦</option>
                <option value="PH">菲律宾</option>
                <option value="NZ">新西兰</option>
                <option value="MY">马来西亚</option>
                <option value="MO">澳门</option>
                <option value="KZ">哈萨克斯坦</option>
                <option value="KR">韩国</option>
                <option value="KH">柬埔寨</option>
                <option value="JP">日本</option>
                <option value="HK">香港</option>
                <option value="AU">澳大利亚</option>
                <option value="CA">加拿大</option>
                <option value="ID">印度尼西亚</option>
                <option value="IN">印度</option>
                <option value="GB">英国</option>
                <option value="IQ">伊拉克</option>
                <option value="AW">阿鲁巴</option>
            </select>
        </div>
    </div>
    
    <div class="layui-form-item">
        <label class="layui-form-label">生日</label>
        <div class="layui-input-inline">
            <input type="text" name="birth_date" id="birth_date" autocomplete="off" placeholder="请选择日期" class="layui-input">
        </div>
    </div>
    
    <div class="layui-form-item">
        <label class="layui-form-label">邮箱<span style="color: red;">*</span></label>
        <div class="layui-input-inline">
            <input type="text" name="email" lay-verify="required|email" placeholder="请输入邮箱" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">平台<span style="color: red;">*</span></label>
        <div class="layui-input-inline">
            <select name="version" lay-verify="required">
                <option value="J1">J1</option>
                <option value="J2" selected>J2</option>
            </select>
        </div>
    </div>
    
    <div class="layui-form-item">
        <label class="layui-form-label">手机号</label>
        <div class="layui-input-inline" style="width: 90px;">
            <select name="nation_code">
                <option value="+1" selected>+1</option>
                <option value="86">+86</option>
                <option value="44">+44</option>
                <option value="81">+81</option>
                <option value="82">+82</option>
                <option value="61">+61</option>
                <option value="49">+49</option>
                <option value="33">+33</option>
                <option value="39">+39</option>
                <option value="7">+7</option>
            </select>
        </div>
        <div class="layui-input-inline" style="width: 180px;">
            <input type="text" name="mobile" placeholder="请输入手机号" autocomplete="off" class="layui-input">
        </div>
    </div>
    
    <div class="address-title">
        <i class="layui-icon layui-icon-location"></i> 账单地址
    </div>
    
    <div class="layui-form-item">
        <label class="layui-form-label">国家/地区<span style="color: red;">*</span></label>
        <div class="layui-input-inline">
            <select name="country" lay-verify="required">
                <option value="US" selected>美国</option>
                <option value="TW">台湾（中国）</option>
                <option value="CN">中国</option>
                <option value="VN">越南</option>
                <option value="TH">泰国</option>
                <option value="SG">新加坡</option>
                <option value="PK">巴基斯坦</option>
                <option value="PH">菲律宾</option>
                <option value="NZ">新西兰</option>
                <option value="MY">马来西亚</option>
                <option value="MO">澳门</option>
                <option value="KZ">哈萨克斯坦</option>
                <option value="KR">韩国</option>
                <option value="KH">柬埔寨</option>
                <option value="JP">日本</option>
                <option value="HK">香港</option>
                <option value="AU">澳大利亚</option>
                <option value="CA">加拿大</option>
                <option value="ID">印度尼西亚</option>
                <option value="IN">印度</option>
                <option value="GB">英国</option>
                <option value="IQ">伊拉克</option>
                <option value="AW">阿鲁巴</option>
            </select>
        </div>
    </div>
    
    <div class="layui-form-item">
        <label class="layui-form-label">省份/州<span style="color: red;">*</span></label>
        <div class="layui-input-inline">
            <input type="text" name="state" lay-verify="required" placeholder="请输入省份/州" autocomplete="off" class="layui-input" value="California">
        </div>
    </div>
    
    <div class="layui-form-item">
        <label class="layui-form-label">城市<span style="color: red;">*</span></label>
        <div class="layui-input-inline">
            <input type="text" name="city" lay-verify="required" placeholder="请输入城市" autocomplete="off" class="layui-input" value="Los Angeles">
        </div>
    </div>
    
    <div class="layui-form-item">
        <label class="layui-form-label">详细地址<span style="color: red;">*</span></label>
        <div class="layui-input-inline">
            <input type="text" name="address" lay-verify="required" placeholder="请输入详细地址" autocomplete="off" class="layui-input" value="1234 Main St">
        </div>
    </div>
    
    <div class="layui-form-item">
        <label class="layui-form-label">邮政编码<span style="color: red;">*</span></label>
        <div class="layui-input-inline">
            <input type="text" name="postcode" lay-verify="required" placeholder="请输入邮政编码" autocomplete="off" class="layui-input" value="90001">
        </div>
    </div>
    
    <div class="layui-form-item">
        <div class="layui-input-block">
            <button class="layui-btn" lay-submit lay-filter="cardHolderSubmit">立即提交</button>
            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
        </div>
    </div>
</form>

<script src="/static/layui/layui.js"></script>
<script src="/static/js/card_holder_add.js"></script>
<!-- <script>
layui.use(['form', 'layer', 'laydate', 'jquery'], function(){
    var form = layui.form;
    var layer = layui.layer;
    var $ = layui.jquery;
    var laydate = layui.laydate;
    
    // 日期选择器
    laydate.render({
        elem: '#birth_date',
        value: new Date() // 默认当天
    });
    
    // 表单提交
    form.on('submit(user-form-submit)', function(data){
        // 将名字和姓氏合并为用户名
        var userData = data.field;
        userData.user_name = userData.last_name + userData.first_name;
        
        // 将电话号码与国家代码合并
        if(userData.phone) {
            userData.mobile = userData.phone_code + userData.phone;
        } else {
            userData.mobile = "";
        }
        
        // 将账单地址国家作为user_id
        if(!userData.user_id) {
            userData.user_id = "ID" + new Date().getTime().toString().slice(-8);
        }
        
        // 国家和地区
        userData.country = userData.billing_country;
        userData.region = userData.billing_country;
        
        // 发送请求
        $.ajax({
            url: '/api/card_holders',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(userData),
            success: function(res){
                if(res.code === 200){
                    layer.msg('添加成功', {icon: 1, time: 1000}, function(){
                        // 关闭当前层
                        var index = parent.layer.getFrameIndex(window.name);
                        parent.layer.close(index);
                        // 刷新父页面表格
                        parent.layui.table.reload('user-table');
                    });
                } else {
                    layer.msg('添加失败：' + res.msg, {icon: 2});
                }
            },
            error: function(xhr){
                layer.msg('请求错误：' + xhr.statusText, {icon: 2});
            }
        });
        
        return false; // 阻止表单跳转
    });
});
</script> -->
</body>
</html> 